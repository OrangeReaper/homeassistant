  # Weather prediction
  - platform: yr
  - platform: template
    sensors:
      dark:
        friendly_name: "It's Dark"
        value_template: >-
         {% if states('sensor.porch_luminance') | int < 50 %}
           yes
         {% else %}
           no
         {% endif %}
  - platform: template
    sensors:
      mancave_occupied:
        friendly_name: "ManCave Occupied"
        value_template: >-
          {% if is_state('device_tracker.tv_mancave', 'home')  %}
            {% if is_state('group.mc_mediaplayers', 'home')  %}
              yes
            {% else %}
              no
            {% endif %}
          {% else %}
            no
          {% endif %}
  - platform: template
    sensors:
      porch_pir_battery:
        friendly_name: "Porch PIR Battery"
        entity_id: zwave.porch_motion_sensor
        value_template: "{{ state_attr('zwave.porch_motion_sensor', 'battery_level')|int|default(75) }}"
        device_class: battery
        unit_of_measurement: '%'
  - platform: template
    sensors:
      hive_battery:
        friendly_name: "Hive Battery"
        value_template: '{{ states.climate.heating.attributes.battery_level | replace("%","") | int }}'
  - platform: template
    sensors:
      nextsunrise:
        friendly_name: 'Next Sunrise'
        value_template: >
          {{ as_timestamp(states.sun.sun.attributes.next_rising) | timestamp_custom(' %I:%M%p') | replace(" 0", "") }}
        icon_template: mdi:weather-sunset-up
      nextsunset:
        friendly_name: 'Next Sunset'
        value_template: >
          {{ as_timestamp(states.sun.sun.attributes.next_setting) | timestamp_custom(' %I:%M%p') | replace(" 0", "") }}
        icon_template: mdi:weather-sunset-down

